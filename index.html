<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TTP Companion</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        :root {
            --red: #c94a4a;
            --red-dark: #a33a3a;
            --red-light: #e07070;
            --cream: #faf5f0;
            --cream-dark: #f0e8e0;
            --gold: #d4a84b;
        }
        
        body {
            font-family: Georgia, 'Times New Roman', serif;
            background: var(--cream);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        /* HEADER */
        .header {
            background: linear-gradient(135deg, var(--red-dark) 0%, var(--red) 100%);
            color: var(--cream);
            padding: 1rem;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }
        
        .header h1 {
            font-size: 1.25rem;
            font-weight: normal;
            letter-spacing: 0.05em;
            text-align: center;
        }
        
        .header-subtitle {
            font-size: 0.75rem;
            text-align: center;
            opacity: 0.8;
            margin-top: 0.25rem;
        }
        
        /* CLASS SELECTOR - Horizontal scroll on mobile */
        .class-selector {
            background: var(--cream-dark);
            border-bottom: 1px solid #ddd;
            padding: 0.75rem 0;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .class-chips {
            display: flex;
            gap: 0.5rem;
            padding: 0 1rem;
            min-width: max-content;
        }
        
        .class-chip {
            background: white;
            border: 1px solid #ddd;
            border-radius: 20px;
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
            white-space: nowrap;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }
        
        .class-chip:hover {
            border-color: var(--red);
        }
        
        .class-chip.active {
            background: var(--red);
            color: white;
            border-color: var(--red);
        }
        
        .class-chip .chip-date {
            font-weight: bold;
        }
        
        .class-chip .chip-topic {
            font-size: 0.75rem;
            opacity: 0.8;
            margin-left: 0.25rem;
        }
        
        /* MAIN CONTENT */
        .main {
            padding: 1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        /* CLASS HEADER */
        .class-header {
            text-align: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #ddd;
        }
        
        .class-date {
            font-size: 0.9rem;
            color: var(--red);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        
        .class-title {
            font-size: 1.5rem;
            color: #222;
            margin-top: 0.25rem;
        }
        
        /* SECTION CARDS */
        .section {
            background: white;
            border-radius: 8px;
            margin-bottom: 1rem;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .section-header {
            background: var(--cream-dark);
            padding: 0.75rem 1rem;
            font-size: 0.85rem;
            font-weight: bold;
            color: var(--red);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-header .toggle {
            font-size: 1.25rem;
            color: var(--red);
        }
        
        .section-content {
            padding: 1rem;
        }
        
        .section-content.collapsed {
            display: none;
        }
        
        /* PRACTICE SECTION - Special styling */
        .section.practice {
            border: 2px solid var(--red);
        }
        
        .section.practice .section-header {
            background: linear-gradient(135deg, var(--red) 0%, var(--red-dark) 100%);
            color: white;
        }
        
        .section.practice .toggle {
            color: white;
        }
        
        .practice-title {
            font-size: 1.1rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.75rem;
        }
        
        .practice-steps {
            list-style: none;
        }
        
        .practice-steps li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .practice-steps li:last-child {
            border-bottom: none;
        }
        
        .practice-steps li::before {
            content: "‚óÜ";
            position: absolute;
            left: 0;
            color: var(--red);
            font-size: 0.6rem;
            top: 0.7rem;
        }
        
        .practice-quote {
            margin-top: 0.75rem;
            font-size: 0.85rem;
            color: #666;
            font-style: italic;
            padding-left: 1rem;
            border-left: 2px solid var(--red-light);
        }
        
        /* COMMENTARY SECTION */
        .commentary-point {
            margin-bottom: 1.25rem;
            padding-bottom: 1.25rem;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .commentary-point:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .commentary-point h4 {
            color: #333;
            font-size: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .commentary-point p {
            font-size: 0.95rem;
            color: #444;
            margin-bottom: 0.5rem;
        }
        
        .commentary-point p:last-child {
            margin-bottom: 0;
        }
        
        .kk-quote {
            font-style: italic;
            color: #555;
            background: var(--cream);
            padding: 0.75rem;
            border-radius: 4px;
            margin-top: 0.5rem;
            font-size: 0.9rem;
        }
        
        .kk-quote::before {
            content: """;
            color: var(--red);
            font-size: 1.5rem;
            line-height: 0;
            vertical-align: -0.3rem;
            margin-right: 0.25rem;
        }
        
        .kk-quote::after {
            content: "" ‚Äî KK";
            color: var(--red);
        }
        
        /* ROOT TEXT SECTIONS */
        .root-text-label {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--red);
            margin-bottom: 0.5rem;
        }
        
        .root-text-title {
            font-size: 1rem;
            font-weight: bold;
            color: #333;
            margin-bottom: 0.75rem;
        }
        
        .root-text-content {
            font-size: 1rem;
            line-height: 1.8;
            color: #444;
            background: var(--cream);
            padding: 1rem;
            border-radius: 4px;
            border-left: 3px solid var(--red);
            max-height: 600px;
            overflow-y: auto;
            white-space: pre-wrap;
            text-indent: 0;
        }
        
        .root-text-content p {
            margin-bottom: 1rem;
        }
        
        .root-text-content p:last-child {
            margin-bottom: 0;
        }
        
        /* PREVIEW SECTION - bold style */
        .section.preview .section-header {
            background: linear-gradient(135deg, var(--red) 0%, var(--red-dark) 100%);
            color: white;
        }
        
        .section.preview .toggle {
            color: var(--red-light);
        }
        
        /* TRANSCRIPT SECTION - light style */
        .section.transcript .section-header {
            background: var(--cream-dark);
            color: var(--red);
        }
        
        .section.transcript .toggle {
            color: var(--red);
        }
        
        /* RECORDING SECTION - light style */
        .section.recording .section-header {
            background: var(--cream-dark);
            color: var(--red);
        }
        
        .section.recording .toggle {
            color: var(--red);
        }
        
        .recording-link {
            display: inline-block;
            padding: 0.75rem 1.25rem;
            background: linear-gradient(135deg, #4a6741 0%, #3d5636 100%);
            color: white;
            text-decoration: none;
            border-radius: 6px;
            font-weight: 500;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .recording-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(74, 103, 65, 0.3);
        }
        
        .transcript-container {
            max-height: 500px;
            overflow-y: auto;
        }
        
        .transcript-session {
            margin-bottom: 1.5rem;
        }
        
        .transcript-session-title {
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #5d4e6d;
            margin-bottom: 0.75rem;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #e8e0f0;
        }
        
        .transcript-segment {
            margin-bottom: 1rem;
            padding-left: 0.75rem;
            border-left: 3px solid #e0d8e8;
        }
        
        .transcript-segment.kk {
            border-left-color: var(--red);
            background: linear-gradient(90deg, rgba(201, 74, 74, 0.05) 0%, transparent 100%);
            padding: 0.5rem 0.75rem;
            margin-left: -0.75rem;
            border-radius: 0 4px 4px 0;
        }
        
        .transcript-meta {
            font-size: 0.75rem;
            color: #888;
            margin-bottom: 0.25rem;
        }
        
        .transcript-speaker {
            font-weight: 600;
            color: #666;
        }
        
        .transcript-segment.kk .transcript-speaker {
            color: var(--red);
        }
        
        .transcript-time {
            color: #aaa;
            margin-left: 0.5rem;
        }
        
        .transcript-text {
            font-size: 0.95rem;
            line-height: 1.6;
            color: #444;
        }
        
        .transcript-prayers {
            background: var(--cream);
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
            font-style: italic;
            color: #666;
        }
        
        .transcript-prayers-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: #999;
            font-style: normal;
            margin-bottom: 0.5rem;
        }
        
        .transcript-prayers-note {
            font-size: 0.85rem;
            color: #777;
        }
        
        .transcript-subsection-title {
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: #888;
            margin: 1.5rem 0 0.75rem 0;
            padding: 0.5rem 0.25rem;
            border-bottom: 1px solid #e0d8e8;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .transcript-subsection-title:hover {
            background: #f8f6fa;
        }
        
        .transcript-subsection-title .toggle {
            font-size: 1rem;
            color: #aaa;
        }
        
        .transcript-subsection-content {
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .transcript-subsection-content.collapsed {
            max-height: 0;
        }
        
        .transcript-prayers-wrapper {
            cursor: pointer;
        }
        
        .transcript-prayers-wrapper:hover .transcript-prayers {
            background: #f5f0e8;
        }
        
        .transcript-prayers {
            background: var(--cream);
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
        }
        
        .transcript-prayers-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .transcript-prayers-header .toggle {
            font-size: 1rem;
            color: #aaa;
        }
        
        .transcript-loading {
            text-align: center;
            padding: 2rem;
            color: #888;
        }
        
        .transcript-unavailable {
            text-align: center;
            padding: 2rem;
            color: #999;
            font-style: italic;
        }
        
        /* LOADING STATE */
        .loading {
            text-align: center;
            padding: 3rem 1rem;
            color: #888;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--cream-dark);
            border-top-color: var(--red);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* ERROR STATE */
        .error {
            text-align: center;
            padding: 3rem 1rem;
            color: #c62828;
        }
        
        .error-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .error p {
            margin-bottom: 1rem;
        }
        
        .error code {
            display: block;
            background: #ffebee;
            padding: 1rem;
            border-radius: 4px;
            font-size: 0.8rem;
            text-align: left;
            overflow-x: auto;
        }
        
        /* NO CONTENT */
        .no-content {
            color: #888;
            font-style: italic;
            padding: 1rem;
            text-align: center;
        }
        
        /* RESPONSIVE - Larger screens */
        @media (min-width: 768px) {
            .header h1 {
                font-size: 1.5rem;
            }
            
            .class-chips {
                justify-content: center;
                flex-wrap: wrap;
            }
            
            .main {
                padding: 1.5rem;
            }
            
            .class-title {
                font-size: 1.75rem;
            }
            
            .root-text-content {
                max-height: 700px;
                font-size: 1.05rem;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <h1>Teacher Training Program</h1>
        <div class="header-subtitle">KMC Brooklyn ¬∑ Meaningful to Behold</div>
    </header>
    
    <nav class="class-selector">
        <div class="class-chips" id="classChips">
            <!-- Classes will be inserted here -->
        </div>
    </nav>
    
    <main class="main" id="mainContent">
        <div class="loading">
            <div class="loading-spinner"></div>
            <p>Loading classes...</p>
        </div>
    </main>

    <script>
        let classesData = [];
        let currentClassId = null;
        
        // Load data from JSON file
        async function loadData() {
            try {
                const response = await fetch('ttp-data.json?v=6');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                classesData = await response.json();
                
                if (classesData.length > 0) {
                    currentClassId = classesData[classesData.length - 1].id; // Start with most recent
                    renderChips();
                    renderContent();
                    // Scroll the class selector to the right to show the latest class
                    const selector = document.querySelector('.class-selector');
                    selector.scrollLeft = selector.scrollWidth;
                } else {
                    showError('No classes found in data file.');
                }
            } catch (error) {
                showError(`Could not load ttp-data.json. Make sure it's in the same folder as this HTML file.\n\nError: ${error.message}`);
            }
        }
        
        // Show error message
        function showError(message) {
            document.getElementById('mainContent').innerHTML = `
                <div class="error">
                    <div class="error-icon">‚ö†Ô∏è</div>
                    <p><strong>Error loading data</strong></p>
                    <code>${message}</code>
                </div>
            `;
        }
        
        // Render class chips
        function renderChips() {
            const container = document.getElementById('classChips');
            container.innerHTML = classesData.map(c => `
                <button class="class-chip ${c.id === currentClassId ? 'active' : ''}" 
                        onclick="selectClass('${c.id}')"
                        data-topic="${c.topic.toLowerCase()}"
                        data-date="${c.date.toLowerCase()}">
                    <span class="chip-date">${c.date}</span>
                    <span class="chip-topic">¬∑ ${c.topic}</span>
                </button>
            `).join('');
        }
        
        // Select a class
        function selectClass(id) {
            currentClassId = id;
            renderChips();
            renderContent();
            // Scroll to top of main content
            document.getElementById('mainContent').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Toggle section collapse
        function toggleSection(el) {
            const content = el.nextElementSibling;
            const toggle = el.querySelector('.toggle');
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                toggle.textContent = '‚àí';
            } else {
                content.classList.add('collapsed');
                toggle.textContent = '+';
            }
        }
        
        // Render practice steps
        function renderPracticeSteps(steps) {
            if (!steps || steps.length === 0) {
                return '<p class="no-content">Practice to be added</p>';
            }
            return `<ul class="practice-steps">${steps.map(s => `<li>${s}</li>`).join('')}</ul>`;
        }
        
        // Render commentary points
        function renderCommentary(points) {
            if (!points || points.length === 0) {
                return '<p class="no-content">Commentary to be added</p>';
            }
            return points.map(point => `
                <div class="commentary-point">
                    <h4>${point.title}</h4>
                    ${point.content.map(p => `<p>${p}</p>`).join('')}
                    ${point.quote ? `<div class="kk-quote">${point.quote}</div>` : ''}
                </div>
            `).join('');
        }
        
        // Render root text content
        function renderRootText(text) {
            if (!text) {
                return '<p class="no-content">Text to be added</p>';
            }
            // Handle both string and array formats
            if (Array.isArray(text)) {
                return text.map(p => `<p>${p}</p>`).join('');
            }
            return text;
        }
        
        // Render transcript session
        function renderTranscriptSession(segments) {
            return segments.map(seg => {
                const isKK = seg.speaker === 'Kadam Kyle';
                return `
                    <div class="transcript-segment ${isKK ? 'kk' : ''}">
                        <div class="transcript-meta">
                            <span class="transcript-speaker">${seg.speaker}</span>
                            <span class="transcript-time">[${seg.time}]</span>
                        </div>
                        <div class="transcript-text">${seg.text.replace(/\n/g, '<br>')}</div>
                    </div>
                `;
            }).join('');
        }
        
        // Render prayers placeholder
        function renderPrayersNote(prayers) {
            if (!prayers) return '';
            if (prayers.text) {
                return `
                    <div class="transcript-prayers-wrapper" onclick="toggleTranscriptSubsection(this)">
                        <div class="transcript-prayers">
                            <div class="transcript-prayers-header">
                                <div class="transcript-prayers-label">Chanted Prayers [${prayers.time}]</div>
                                <span class="toggle">+</span>
                            </div>
                            <div class="transcript-subsection-content collapsed">
                                <div class="transcript-prayers-text">${prayers.text.replace(/\n/g, '<br>')}</div>
                            </div>
                        </div>
                    </div>
                `;
            }
            return `
                <div class="transcript-prayers">
                    <div class="transcript-prayers-label">Chanted Prayers [${prayers.time}]</div>
                    <div class="transcript-prayers-note">${prayers.note || '[Prayers]'}</div>
                </div>
            `;
        }
        
        // Render a collapsible transcript subsection
        function renderCollapsibleSubsection(title, segments, startCollapsed = true) {
            if (!segments || segments.length === 0) return '';
            const collapsedClass = startCollapsed ? 'collapsed' : '';
            const toggleSymbol = startCollapsed ? '+' : '‚àí';
            return `
                <div class="transcript-subsection">
                    <div class="transcript-subsection-title" onclick="toggleTranscriptSubsection(this)">
                        <span>${title}</span>
                        <span class="toggle">${toggleSymbol}</span>
                    </div>
                    <div class="transcript-subsection-content ${collapsedClass}">
                        ${renderTranscriptSession(segments)}
                    </div>
                </div>
            `;
        }
        
        // Toggle transcript subsection
        function toggleTranscriptSubsection(el) {
            const content = el.querySelector('.transcript-subsection-content') || el.nextElementSibling;
            const toggle = el.querySelector('.toggle');
            if (content && content.classList.contains('transcript-subsection-content')) {
                if (content.classList.contains('collapsed')) {
                    content.classList.remove('collapsed');
                    content.style.maxHeight = content.scrollHeight + 'px';
                    if (toggle) toggle.textContent = '‚àí';
                } else {
                    content.classList.add('collapsed');
                    content.style.maxHeight = '0';
                    if (toggle) toggle.textContent = '+';
                }
            }
        }
        
        // Load and render transcript
        async function loadTranscript(classId, container) {
            container.innerHTML = '<div class="transcript-loading">Loading transcript...</div>';
            
            try {
                const response = await fetch(`transcript-${classId}.json?v=2`);
                if (!response.ok) {
                    container.innerHTML = '<div class="transcript-unavailable">Transcript not yet available for this class.</div>';
                    return;
                }
                
                const transcript = await response.json();
                
                let html = '<div class="transcript-container">';
                
                // Session 1
                html += '<div class="transcript-session">';
                html += '<div class="transcript-session-title">Session 1</div>';
                
                // Chanted prayers (collapsible)
                html += renderPrayersNote(transcript.session1.chantedPrayers);
                
                // Guided meditation (collapsible)
                html += renderCollapsibleSubsection('Guided Meditation', transcript.session1.guidedMeditation);
                
                // Class intro (collapsible)
                html += renderCollapsibleSubsection('Class Introduction', transcript.session1.classIntro);
                
                // Shantideva reading (collapsible)
                html += renderCollapsibleSubsection('Shantideva Reading', transcript.session1.shantidevaReading);
                
                // Post-reading / Class overview (collapsible)
                html += renderCollapsibleSubsection('Class Overview', transcript.session1.postReading);
                
                // Teaching (collapsible)
                html += renderCollapsibleSubsection('Practice Sharing & Discussion', transcript.session1.teaching);
                
                // Main Teaching (collapsible)
                html += renderCollapsibleSubsection('Session 1 Teaching', transcript.session1.mainTeaching);
                
                html += '</div>';
                
                // Session 2
                html += '<div class="transcript-session">';
                html += '<div class="transcript-session-title">Session 2</div>';
                
                // Chanted prayers
                html += renderPrayersNote(transcript.session2.chantedPrayers);
                
                // Teaching (collapsible)
                html += renderCollapsibleSubsection('Teaching & Discussion', transcript.session2.teaching);
                
                // Conclusion (collapsible)
                html += renderCollapsibleSubsection('Conclusion & Dedication', transcript.session2.conclusion);
                
                html += '</div>';
                
                html += '</div>';
                
                container.innerHTML = html;
            } catch (error) {
                container.innerHTML = '<div class="transcript-unavailable">Transcript not yet available for this class.</div>';
            }
        }
        
        // Toggle transcript section (special handling for lazy loading)
        function toggleTranscript(el, classId) {
            const content = el.nextElementSibling;
            const toggle = el.querySelector('.toggle');
            
            if (content.classList.contains('collapsed')) {
                content.classList.remove('collapsed');
                toggle.textContent = '‚àí';
                
                // Load transcript if not already loaded
                if (content.dataset.loaded !== 'true') {
                    loadTranscript(classId, content);
                    content.dataset.loaded = 'true';
                }
            } else {
                content.classList.add('collapsed');
                toggle.textContent = '+';
            }
        }
        
        // Render main content
        function renderContent() {
            const cls = classesData.find(c => c.id === currentClassId);
            if (!cls) {
                showError('Class not found');
                return;
            }
            
            const container = document.getElementById('mainContent');
            
            container.innerHTML = `
                <div class="class-header">
                    <div class="class-date">${cls.date}, ${cls.year || '2025'}</div>
                    <h2 class="class-title">${cls.topic}</h2>
                </div>
                
                <!-- PRACTICE -->
                <section class="section practice">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>‚ò∏ This Week's Practice</span>
                        <span class="toggle">+</span>
                    </div>
                    <div class="section-content collapsed">
                        ${cls.practice?.title ? `<div class="practice-title">${cls.practice.title}</div>` : ''}
                        ${renderPracticeSteps(cls.practice?.steps)}
                        ${cls.practice?.quote ? `<div class="practice-quote">"${cls.practice.quote}" ‚Äî KK</div>` : ''}
                    </div>
                </section>
                
                <!-- COMMENTARY -->
                <section class="section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>üìñ Kadam Kyle's Commentary</span>
                        <span class="toggle">+</span>
                    </div>
                    <div class="section-content collapsed">
                        ${renderCommentary(cls.commentary)}
                    </div>
                </section>
                
                <!-- MTB ROOT TEXT -->
                <section class="section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>üìò Meaningful to Behold</span>
                        <span class="toggle">+</span>
                    </div>
                    <div class="section-content collapsed">
                        <div class="root-text-label">Section Covered</div>
                        <div class="root-text-title">${cls.mtb?.title || 'Section title to be added'}</div>
                        <div class="root-text-content">
                            ${renderRootText(cls.mtb?.content)}
                        </div>
                    </div>
                </section>
                
                <!-- SHANTIDEVA -->
                <section class="section">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>üìú Guide to the Bodhisattva's Way of Life</span>
                        <span class="toggle">+</span>
                    </div>
                    <div class="section-content collapsed">
                        <div class="root-text-label">Verses Recited</div>
                        <div class="root-text-title">${cls.shantideva?.title || 'Verses to be added'}</div>
                        <div class="root-text-content">
                            ${renderRootText(cls.shantideva?.content)}
                        </div>
                    </div>
                </section>
                
                <!-- RECORDING -->
                <section class="section recording">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>üéß Class Recording</span>
                        <span class="toggle">+</span>
                    </div>
                    <div class="section-content collapsed">
                        ${cls.recording ? `<a href="${cls.recording}" target="_blank" class="recording-link">‚ñ∂ Listen to the full class recording on Google Drive</a>` : '<p class="no-content">Recording not yet available</p>'}
                    </div>
                </section>
                
                <!-- TRANSCRIPT -->
                <section class="section transcript">
                    <div class="section-header" onclick="toggleTranscript(this, '${cls.id}')">
                        <span>üìù Class Transcript</span>
                        <span class="toggle">+</span>
                    </div>
                    <div class="section-content collapsed" data-loaded="false">
                        <div class="transcript-loading">Click to load transcript...</div>
                    </div>
                </section>
                
                <!-- PREVIEW / NEXT WEEK -->
                <section class="section preview">
                    <div class="section-header" onclick="toggleSection(this)">
                        <span>üëÅ Next Week's Reading</span>
                        <span class="toggle">+</span>
                    </div>
                    <div class="section-content collapsed">
                        <div class="root-text-label">Preview from MTB</div>
                        <div class="root-text-title">${cls.preview?.title || 'Preview to be added'}</div>
                        <div class="root-text-content">
                            ${renderRootText(cls.preview?.content)}
                        </div>
                    </div>
                </section>
            `;
        }
        
        // Initialize
        loadData();
    </script>
</body>
</html>
